!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).visualizer=t()}}(function(){return function t(e,n,o){function i(a,c){if(!n[a]){if(!e[a]){var l="function"==typeof require&&require;if(!c&&l)return l(a,!0);if(r)return r(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var s=n[a]={exports:{}};e[a][0].call(s.exports,function(t){var n=e[a][1][t];return i(n||t)},s,s.exports,t,e,n,o)}return n[a].exports}for(var r="function"==typeof require&&require,a=0;a<o.length;a++)i(o[a]);return i}({1:[function(t,e,n){const o=t("get-user-media-promise"),i=t("next-tick-2"),r=t("raf"),a=t("./lib/vizRadialArcs"),c=t("./lib/vizRadialBars"),l=t("./lib/vizFlyout"),u=t("./lib/vizSunburst"),s=t("./lib/vizBoxes"),f=t("./lib/vizSpikes"),h=t("./lib/vizImage");e.exports=function(t={}){const e=t.parent?document.querySelector(t.parent):window,n=document.createElement("canvas");t.parent?e.appendChild(n):(n.style.position="absolute",n.style.left="0",n.style.top="0",document.body.appendChild(n));const d=n.getContext("2d"),m=t.image,p=[];let g=0;const v=Math.round(256/3);let b,w;const y=[],M=2*Math.PI/v;let x=function(t){const e=new(window.AudioContext||window.webkitAudioContext),o=e.createMediaStreamSource(t);(b=e.createAnalyser()).smoothingTimeConstant=.2,b.fftSize=256,w=new Uint8Array(b.frequencyBinCount),o.connect(b);for(let t=0;t<v;t++)y.push(0);const i={cv:n,ctx:d,bandCount:v,rotateAmount:M,lastVolumes:y,image:m,fftSize:256};p.push(a(i)),p.push(c(i)),p.push(l(i)),p.push(u(i)),p.push(s(i)),p.push(f(i)),p.push(h(i)),E(),R(),window.onresize=function(){E()}},z=function(t){const e={cv:n,ctx:d,bandCount:v,rotateAmount:M,lastVolumes:y,image:m,fftSize:256};p.push(t(e))},T=function(){g=(g+1)%p.length,E()},C=function(t){t<0&&(t=0),t>=p.length&&(t=p.length-1),g=t,E()},S=function(){p[g].vary&&p[g].vary()},E=function(){const t=window.devicePixelRatio||1,o=e.innerWidth||e.clientWidth,i=e.innerHeight||e.clientHeight;n.width=o*t,n.height=i*t,n.style.width=o+"px",n.style.height=i+"px",p[g].resize()},R=function(){if(b.getByteFrequencyData(w),!0===p[g].dampen)for(let t=0;t<w.length;t++)y[t]>w[t]&&(w[t]=(w[t]+y[t])/2);p[g].draw(w),r(R)};return function(e){if(t.stream)return i(function(){e(null,t.stream)});o({video:!1,audio:!0}).then(function(t){e(null,t)}).catch(function(t){e(t)})}(function(t,e){if(t)throw console.log(t),new Error("Unable to start visualization. Make sure you're using Chrome or Firefox with a microphone set up, and that you allow the page to access the microphone.");x(e)}),Object.freeze({addVisualization:z,showNextVisualization:T,showVisualization:C,vary:S})}},{"./lib/vizBoxes":5,"./lib/vizFlyout":6,"./lib/vizImage":7,"./lib/vizRadialArcs":8,"./lib/vizRadialBars":9,"./lib/vizSpikes":10,"./lib/vizSunburst":11,"get-user-media-promise":13,"next-tick-2":14,raf:17}],2:[function(t,e,n){const o=t("./hsv-to-rgb"),i=[],r=[];!function(){for(let t=0;t<360;t++)for(let e=0;e<100;e++){const n=o(t/360,1,e/100,!0,!1);i.push(n);const a=o(t/360,1,e/100,!1,!0);r.push(a)}}(),e.exports={bigColorMap:i,bigColorMap2:r}},{"./hsv-to-rgb":4}],3:[function(t,e,n){e.exports=function(t){let e,n=document.createElement("canvas"),o=n.getContext("2d");n.width=300,n.height=300,(e=o.createRadialGradient(150,150,0,150,150,150)).addColorStop(0,"rgba(255, 255, 255, 1.000)"),e.addColorStop(1,"rgba(255, 255, 255, 0.000)"),o.fillStyle=e,o.fillRect(0,0,300,300),t.src=n.toDataURL()}},{}],4:[function(t,e,n){function o(t){let e=t.toString(16);return 1===e.length?"0"+e:e}e.exports=function(t,e,n,i,r){let a,c,l,u,s,f,h,d;switch(t&&void 0===e&&void 0===n&&(e=t.s,n=t.v,t=t.h),u=Math.floor(6*t),s=6*t-u,f=n*(1-e),h=n*(1-s*e),d=n*(1-(1-s)*e),u%6){case 0:a=n,c=d,l=f;break;case 1:a=h,c=n,l=f;break;case 2:a=f,c=n,l=d;break;case 3:a=f,c=h,l=n;break;case 4:a=d,c=f,l=n;break;case 5:a=n,c=f,l=h}return a=Math.floor(255*a),c=Math.floor(255*c),l=Math.floor(255*l),i?"#"+o(a)+o(c)+o(l):r?[a,c,l]:"rgb("+a+","+c+","+l+")"}},{}],5:[function(t,e,n){const o=t("clamp"),i=t("./big-color-map");e.exports=function(t={}){let{ctx:ctx,cv:cv}=t;let e,n,r=0,a=[[!1],[!0]],c=0,l=function(t){c+=.25,ctx.clearRect(0,0,cv.width,cv.height);let n=0,r=Math.floor(5),a=r,l=0,u=0,s=0,f=cv.width/11,h=cv.height/11;for(;n<121;){switch(l%4){case 0:u=1,s=0;break;case 1:u=0,s=1;break;case 2:u=-1,s=0;break;case 3:u=0,s=-1}for(var d=0;d<Math.floor(l/2)+1;d++){let l=Math.floor(360/121*n+c)%360,d=o(Math.floor(t[n]/1.5),10,99);ctx.fillStyle=i.bigColorMap[100*l+d];let m=.9;e&&(m=t[n]/255/4+.65),ctx.fillRect(r*f+f/2*(1-m),a*h+h/2*(1-m),f*m,h*m),r+=u,a+=s,n++}l++}ctx.setTransform(1,0,0,1,0,0)},u=function(){n=Math.max(cv.width,cv.height)},s=function(){e=a[r=(r+1)%a.length][0]};return s(),Object.freeze({dampen:!0,vary:s,resize:u,draw:l})}},{"./big-color-map":2,clamp:12}],6:[function(t,e,n){const o=t("clamp"),i=t("./hsv-to-rgb");e.exports=function(t={}){let{ctx:ctx,cv:cv,bandCount:bandCount,rotateAmount:rotateAmount}=t;let e,n,r,a,c,l=0,u=0;const s=[[2],[3]],f=[];for(let t=0;t<bandCount;t++)f.push(0);let h=function(t){ctx.save(),ctx.clearRect(0,0,cv.width,cv.height),ctx.translate(cv.width/2,cv.height/2),ctx.rotate(l);for(let c=0;c<bandCount;c++){ctx.rotate(rotateAmount),ctx.lineWidth=1+t[c]/256*5;let l=360/bandCount*c/360,u=o(1*t[c]/150,.3,1);ctx.strokeStyle=i(l,1,u),f[c]+=Math.max(50,t[c])*n/40,f[c]%=a;for(var e=0;e<r;e++)p(f[c]+e*a,.75*rotateAmount)}l+=.002,ctx.restore()},d=function(){const t=Math.min(cv.width,cv.height);e=Math.max(cv.width,cv.height),n=1/800*t,a=(c=.71*e)/r},m=function(){r=s[u=(u+1)%s.length][0]},p=function(t,e){ctx.beginPath(),ctx.arc(0,0,t,0,e),ctx.stroke(),ctx.closePath()};return m(),Object.freeze({dampen:!1,resize:d,draw:h,vary:m})}},{"./hsv-to-rgb":4,clamp:12}],7:[function(t,e,n){const o=t("clamp"),i=t("./big-color-map");e.exports=function(t={}){let{ctx:ctx,cv:cv,bandCount:bandCount,image:image,fftSize:fftSize}=t;let e,n,r,a,c,l;const u=[];let s,f,h=0,d=function(t){if(l){ctx.save(),ctx.clearRect(0,0,cv.width,cv.height),ctx.translate(r,a),h+=1;for(let e=0;e<u.length;e++){let n=u[e],r=Math.floor(t[n]+h)%360,a=100*Math.sqrt(n/t.length*(t[n]/fftSize));a=o(Math.floor(a),0,99);let c=i.bigColorMap2[100*r+a];l.data[4*e]=c[0],l.data[4*e+1]=c[1],l.data[4*e+2]=c[2]}f.putImageData(l,0,0),ctx.scale(c,c),ctx.drawImage(s,0,0),ctx.restore()}},m=function(){s.width=e,s.height=n;const t=cv.parentElement.innerWidth||cv.parentElement.clientWidth,o=cv.parentElement.innerHeight||cv.parentElement.clientHeight,i=Math.floor(t/e),l=Math.floor(o/n);0===(c=Math.min(i,l))&&(c=1),c*=window.devicePixelRatio||1,r=Math.floor((cv.width-e*c)/2),a=Math.floor((cv.height-n*c)/2),ctx.mozImageSmoothingEnabled=!1,ctx.webkitImageSmoothingEnabled=!1,ctx.msImageSmoothingEnabled=!1,ctx.imageSmoothingEnabled=!1},p=function(t){e=t.width,n=t.height,(s=document.createElement("canvas")).width=e,s.height=n,(f=s.getContext("2d")).clearRect(0,0,e,n),f.drawImage(t,0,0,e,n);const i=f.getImageData(0,0,e,n);l=f.createImageData(e,n);for(let t=0;t<e*n;t++){let e=Math.round(.2126*i.data[4*t]+.7152*i.data[4*t+1]+.0722*i.data[4*t+2]);u.push(Math.round(o(e,0,255)/255*bandCount)),l.data[4*t+3]=e<1?0:255}};if(image){let t=document.createElement("img");t.onload=function(){p(t),m()},t.src=image}return Object.freeze({dampen:!0,resize:m,draw:d})}},{"./big-color-map":2,clamp:12}],8:[function(t,e,n){const o=t("clamp"),i=t("./big-color-map");e.exports=function(t={}){let{ctx:ctx,cv:cv,bandCount:bandCount,rotateAmount:rotateAmount}=t;let e,n,r,a,c=0,l=0,u=[[!1,!0],[!0,!1],[!1,!1]],s=function(){r=u[l=(l+1)%u.length][0],a=u[l][1]},f=function(){const t=Math.min(cv.width,cv.height);e=.10625*t,n=1/800*t},h=function(t){ctx.clearRect(0,0,cv.width,cv.height),ctx.translate(cv.width/2,cv.height/2),ctx.rotate(c);for(let c=0;c<bandCount;c++){ctx.rotate(rotateAmount);let l=Math.floor(360/bandCount*c),u=99;a&&(u=o(Math.floor(t[c]/1.5),25,99)),ctx.fillStyle=i.bigColorMap[100*l+u],ctx.beginPath(),r?ctx.arc(0,0,e+Math.max(t[c]*n,2),0,rotateAmount/2):ctx.arc(0,0,e+Math.max(t[c]*n,2),0,rotateAmount+.005),ctx.lineTo(0,0),ctx.fill(),ctx.closePath()}ctx.fillStyle="#000000",ctx.beginPath(),ctx.arc(0,0,e,0,2*Math.PI,!1),ctx.fill(),ctx.closePath(),c+=.002,ctx.setTransform(1,0,0,1,0,0)};return s(),Object.freeze({dampen:!0,vary:s,resize:f,draw:h})}},{"./big-color-map":2,clamp:12}],9:[function(t,e,n){const o=t("clamp"),i=t("./big-color-map");e.exports=function(t={}){let e,n,r,a,{ctx:ctx,cv:cv,bandCount:bandCount,rotateAmount:rotateAmount,lastVolumes:lastVolumes}=t;let c=0,l=[[!1],[!0]],u=0,s=function(t){ctx.clearRect(0,0,cv.width,cv.height),ctx.translate(cv.width/2,cv.height/2),ctx.rotate(u);for(let c=0;c<bandCount;c++){ctx.rotate(rotateAmount);let l=Math.floor(360/bandCount*c);if(n){let n=o(Math.floor(t[c]/1.5),25,99);ctx.fillStyle=i.bigColorMap[100*l+n],ctx.fillRect(-e/2,r,e,Math.max(2,t[c]*a))}else{let n=0;n=(t[c]+lastVolumes[c])/2,ctx.fillStyle=i.bigColorMap[100*l+50],ctx.fillRect(-e/2,r+n,e,2),ctx.fillStyle=i.bigColorMap[100*l+99],ctx.fillRect(-e/2,r,e,t[c]*a)}}u+=.002,ctx.setTransform(1,0,0,1,0,0)},f=function(){n=l[c=(c+1)%l.length][0]},h=function(){const t=Math.min(cv.width,cv.height);r=.10625*t,a=1/800*t,e=2*Math.PI*r/bandCount};return f(),Object.freeze({dampen:!0,vary:f,resize:h,draw:s})}},{"./big-color-map":2,clamp:12}],10:[function(t,e,n){const o=t("clamp"),i=t("./big-color-map");e.exports=function(t={}){let{ctx:ctx,cv:cv,bandCount:bandCount,rotateAmount:rotateAmount}=t;let e,n,r,a=0,c=function(t){a+=1,ctx.clearRect(0,0,cv.width,cv.height),ctx.translate(cv.width/2,cv.height/2),ctx.rotate(Math.PI/2);for(let c=0;c<bandCount;c++){let l=Math.floor(360/bandCount*c+a)%360,u=o(Math.floor(t[c]/1.5),15,99);ctx.fillStyle=i.bigColorMap[100*l+u];let s=r/2;s-=(s-e)*(t[c]/255),ctx.beginPath(),ctx.arc(0,0,n/2,-rotateAmount/2,rotateAmount/2),ctx.lineTo(s,0),ctx.fill(),ctx.closePath(),ctx.rotate(rotateAmount)}ctx.setTransform(1,0,0,1,0,0)},l=function(){r=Math.min(cv.width,cv.height),n=Math.sqrt(cv.width*cv.width+cv.height*cv.height),e=.10625*r};return Object.freeze({dampen:!0,resize:l,draw:c})}},{"./big-color-map":2,clamp:12}],11:[function(t,e,n){function o(){this.cx=-200,this.cy=-200,this.regenerate()}const i=t("clamp"),r=t("./big-color-map"),a=t("./create-gradient-texture");o.prototype.regenerate=function(){var t=2*Math.random()*Math.PI;this.x=Math.cos(t)*Math.random()*500+this.cx,this.y=Math.sin(t)*Math.random()*500+this.cy,t=2*Math.random()*Math.PI,this.dx=Math.cos(t),this.dy=Math.sin(t),this.intensity=0,this.di=.01+Math.random()/50},o.prototype.move=function(){this.x+=this.dx*Math.random()*4,this.y+=this.dy*Math.random()*4,this.intensity+=this.di,this.intensity<0?this.regenerate():this.intensity>1&&(this.intensity=1,this.di*=-1)},e.exports=function(t={}){let{ctx:ctx,cv:cv,bandCount:bandCount,rotateAmount:rotateAmount}=t;let e,n,c=0,l=[!0,!1],u=0,s=document.createElement("img");a(s);let f=[];for(let t=0;t<25;t++)f.push(new o);let h=function(t){if(ctx.save(),ctx.fillStyle="#000000",ctx.fillRect(0,0,cv.width,cv.height),ctx.translate(cv.width/2,cv.height/2),e){ctx.globalCompositeOperation="screen";for(let t=0;t<f.length;t++)ctx.globalAlpha=f[t].intensity,ctx.drawImage(s,f[t].x,f[t].y),f[t].move()}ctx.rotate(u),e&&(ctx.globalCompositeOperation="multiply",ctx.globalAlpha=1);for(let e=0;e<bandCount;e++){ctx.rotate(rotateAmount);let o=Math.floor(360/bandCount*e)%360,a=i(Math.floor(t[e]/2),10,99);ctx.fillStyle=r.bigColorMap[100*o+a],ctx.beginPath(),ctx.arc(0,0,1.5*n,0,rotateAmount+.1),ctx.lineTo(0,0),ctx.fill(),ctx.closePath()}u+=.002,ctx.restore()},d=function(){n=Math.max(cv.width,cv.height)},m=function(){e=l[c=(c+1)%l.length]};return m(),Object.freeze({dampen:!0,vary:m,resize:d,draw:h})}},{"./big-color-map":2,"./create-gradient-texture":3,clamp:12}],12:[function(t,e,n){function o(t,e,n){return e<n?t<e?e:t>n?n:t:t<n?n:t>e?e:t}e.exports=o},{}],13:[function(t,e,n){!function(t){"use strict";function n(){this.name="NotSupportedError",this.message="getUserMedia is not implemented in this browser"}function o(){this.then=function(){return this};var t=new n;this.catch=function(e){setTimeout(function(){e(t)})}}function i(t){return r?c?navigator.mediaDevices.getUserMedia(t):new Promise(function(e,o){if(!l)return o(new n);l.call(navigator,t,e,o)}):new o}n.prototype=Error.prototype;var r="undefined"!=typeof Promise,a="undefined"!=typeof navigator,c=a&&navigator.mediaDevices&&navigator.mediaDevices.getUserMedia,l=a&&(navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia);i.NotSupportedError=n,i.isSupported=!(!r||!c&&!l),"object"==typeof e&&e.exports?e.exports=i:(t.navigator=t.navigator||{},t.nagivator.mediaDevices=t.navigator.mediaDevices||{},t.nagivator.mediaDevices.getUserMedia=t.nagivator.mediaDevices.getUserMedia||i)}(this)},{}],14:[function(t,e,n){"use strict";var o=function(t){if("function"!=typeof t)throw new TypeError(t+" is not a function");return t},i=function(t){var e,n,i=document.createTextNode(""),r=0;return new t(function(){var t;if(e)n&&(e=n.concat(e));else{if(!n)return;e=n}if(n=e,e=void 0,"function"==typeof n)return t=n,n=void 0,void t();for(i.data=r=++r%2;n;)t=n.shift(),n.length||(n=void 0),t()}).observe(i,{characterData:!0}),function(t){if(o(t),e)return void("function"==typeof e?e=[e,t]:e.push(t));e=t,i.data=r=++r%2}};e.exports=function(){if("object"==typeof document&&document){if("function"==typeof MutationObserver)return i(MutationObserver);if("function"==typeof WebKitMutationObserver)return i(WebKitMutationObserver)}return"function"==typeof setImmediate?function(t){setImmediate(o(t))}:"function"==typeof setTimeout||"object"==typeof setTimeout?function(t){setTimeout(o(t),0)}:void 0}()},{}],15:[function(t,e,n){(function(t){(function(){var n,o,i,r,a,c;"undefined"!=typeof performance&&null!==performance&&performance.now?e.exports=function(){return performance.now()}:void 0!==t&&null!==t&&t.hrtime?(e.exports=function(){return(n()-a)/1e6},o=t.hrtime,r=(n=function(){var t;return 1e9*(t=o())[0]+t[1]})(),c=1e9*t.uptime(),a=r-c):Date.now?(e.exports=function(){return Date.now()-i},i=Date.now()):(e.exports=function(){return(new Date).getTime()-i},i=(new Date).getTime())}).call(this)}).call(this,t("_process"))},{_process:16}],16:[function(t,e,n){function o(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function r(t){if(f===setTimeout)return setTimeout(t,0);if((f===o||!f)&&setTimeout)return f=setTimeout,setTimeout(t,0);try{return f(t,0)}catch(e){try{return f.call(null,t,0)}catch(e){return f.call(this,t,0)}}}function a(t){if(h===clearTimeout)return clearTimeout(t);if((h===i||!h)&&clearTimeout)return h=clearTimeout,clearTimeout(t);try{return h(t)}catch(e){try{return h.call(null,t)}catch(e){return h.call(this,t)}}}function c(){g&&m&&(g=!1,m.length?p=m.concat(p):v=-1,p.length&&l())}function l(){if(!g){var t=r(c);g=!0;for(var e=p.length;e;){for(m=p,p=[];++v<e;)m&&m[v].run();v=-1,e=p.length}m=null,g=!1,a(t)}}function u(t,e){this.fun=t,this.array=e}function s(){}var f,h,d=e.exports={};!function(){try{f="function"==typeof setTimeout?setTimeout:o}catch(t){f=o}try{h="function"==typeof clearTimeout?clearTimeout:i}catch(t){h=i}}();var m,p=[],g=!1,v=-1;d.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];p.push(new u(t,e)),1!==p.length||g||r(l)},u.prototype.run=function(){this.fun.apply(null,this.array)},d.title="browser",d.browser=!0,d.env={},d.argv=[],d.version="",d.versions={},d.on=s,d.addListener=s,d.once=s,d.off=s,d.removeListener=s,d.removeAllListeners=s,d.emit=s,d.prependListener=s,d.prependOnceListener=s,d.listeners=function(t){return[]},d.binding=function(t){throw new Error("process.binding is not supported")},d.cwd=function(){return"/"},d.chdir=function(t){throw new Error("process.chdir is not supported")},d.umask=function(){return 0}},{}],17:[function(t,e,n){(function(n){for(var o=t("performance-now"),i="undefined"==typeof window?n:window,r=["moz","webkit"],a="AnimationFrame",c=i["request"+a],l=i["cancel"+a]||i["cancelRequest"+a],u=0;!c&&u<r.length;u++)c=i[r[u]+"Request"+a],l=i[r[u]+"Cancel"+a]||i[r[u]+"CancelRequest"+a];if(!c||!l){var s=0,f=0,h=[];c=function(t){if(0===h.length){var e=o(),n=Math.max(0,1e3/60-(e-s));s=n+e,setTimeout(function(){var t=h.slice(0);h.length=0;for(var e=0;e<t.length;e++)if(!t[e].cancelled)try{t[e].callback(s)}catch(t){setTimeout(function(){throw t},0)}},Math.round(n))}return h.push({handle:++f,callback:t,cancelled:!1}),f},l=function(t){for(var e=0;e<h.length;e++)h[e].handle===t&&(h[e].cancelled=!0)}}e.exports=function(t){return c.call(i,t)},e.exports.cancel=function(){l.apply(i,arguments)},e.exports.polyfill=function(){i.requestAnimationFrame=c,i.cancelAnimationFrame=l}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"performance-now":15}]},{},[1])(1)});
